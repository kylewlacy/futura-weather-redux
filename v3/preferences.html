<!doctype html>
<html>
	<head>
		<title>Futura Weather Redux Preferences</title>
		<style type="text/css">
			body {
				font-family: futura, sans-serif;
			}
			
			label, select, input, button {
				display: block;
			}
			
			select, input, button {
				margin-bottom: 18px;
			}
		</style>
		<script>			
			function queryStringParams() {
				var params = {};
				var queries = window.location.search.substring(1).split("&");
				for(var i = 0; i < queries.length; i++) {
					var p = queries[i].split("=");
					params[p[0]] = p[1];
				}
				
				return params;
			}
			
			window.onload = function() {
				var params = queryStringParams();
				for(var key in params) {
					var elements = document.getElementsByName(key);
					if(elements.length > 0) {
						var e = elements[0];
						if(e.type == "checkbox")
							e.checked = (params[key] != 0);
						else
							e.value = params[key];
					}
				}
			};
			
				
			window.onsubmit = function(e) {
				var params = {};
				var children = e.target.childNodes;
				for(var i = 0; i < children.length; i++) {
					if(children[i].name && children[i].value) {
						if(children[i].type == "checkbox")
							params[children[i].name] = children[i].checked ? 1 : 0;
						else
							params[children[i].name] = children[i].value;
					}
				}
				
				window.location = "pebblejs://close#" + JSON.stringify(params);
				return false;
			}
		</script>
	</head>
	<body>
		<h1>Futura Weather Redux</h1>
		<form name="preferences">
			<label for="tempFormat">Temperature format</label>
			<select name="tempFormat">
				<option value="1">Celsius</option>
				<option value="2">Fahrenheit</option>
			</select>
			<label for="weatherUpdateFreq">Weather Update Frequency</label>
			<select name="weatherUpdateFreq">
				<option value="600">Every 10 minutes</option>
				<option value="900">Every 15 minutes</option>
				<option value="1800">Every 30 minutes</option>
				<option value="3600">Every hour</option>
			</select>
			<label for="provider">Data provider</label>
			<select name="provider">
				<option value="1">Open Weather Map</option>
				<option value="2">Yahoo! Weather</option>
			</select>
			<label for="language">Language</label>
			<select name="language">
				<option value="0">English</option>
				<option value="1">Svenska</option>
				<option value="2">Dansk</option>
				<option value="3">Nederlands</option>
				<option value="4">Français</option>
				<option value="5">Suomi</option>
				<option value="6">Deutsch</option>
				<option value="7">Italiano</option>
				<option value="8">Español</option>
				<option value="9">Norsk</option>
			</select>
			<label for="statusbar">Show statusbar</label>
			<input name="statusbar" type="checkbox" />
			<button name="save" type="submit">Save</button>
		</form>
	</body>
</html>
